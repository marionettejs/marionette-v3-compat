!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("underscore"),require("backbone.marionette"),require("backbone.radio"),require("backbone")):"function"==typeof define&&define.amd?define(["underscore","backbone.marionette","backbone.radio","backbone"],t):e.mnV3Compat=t(e._,e.Marionette,e.Radio,e.Backbone)}(this,function(e,t,i,n){"use strict";function r(){function n(){t.deprecate("Global channels are deprecated.  Create your own Radio channels.")}var r=t.Application.prototype.constructor;t.Application=t.Application.extend({constructor:function(){this._initV2Channel(),r.apply(this,arguments)},execute:function(){this.commands.execute.apply(this.commands,arguments)},request:function(){return this.reqres.request.apply(this.reqres,arguments)},_initV2Channel:function(){this.channelName=e.result(this,"channelName")||"global",this.channel=e.result(this,"channel")||i.channel(this.channelName),this.channel.__deprecateChannel=!0,this.vent=this.channel,this.reqres=this.channel,this.commands=this.channel;var r=this.channel.on;this.channel.on=function(){return n(),r.apply(this,arguments)};var o=this.channel.request;this.channel.request=function(){return n(),o.apply(this,arguments)},this.channel.execute=function(){return n(),t.deprecate("Channel commands are deprecated.  Use requests."),o.apply(this,arguments)};var s=t.Object.listenTo;t.Object.listenTo=function(e){e.__deprecateChannel&&n(),s.apply(this,arguments)}}})}function o(){var i=t.bindEvents,n=t.unbindEvents;t.bindEvents=function(n,r,o){return e.isFunction(o)&&(t.deprecate("bindEvents no longer accepts bindings as a function in v3"),o=o.call(n)),i(n,r,o)},t.unbindEvents=function(i,r,o){return e.isFunction(o)&&(t.deprecate("unbindEvents no longer accepts bindings as a function in v3"),o=o.call(i)),n(i,r,o)},t.bindEntityEvents=function(e,i,n){return t.deprecate("bindEntityEvents has been renamed to bindEvents in v3."),t.bindEvents(e,i,n)},t.unbindEntityEvents=function(e,i,n){return t.deprecate("unbindEntityEvents renamed to unbindEvents in v3."),t.unbindEvents(e,i,n)};var r={bindEntityEvents:function(){t.deprecate("bindEntityEvents has been renamed to bindEvents in v3.");for(var e=arguments.length,i=Array(e),n=0;n<e;n++)i[n]=arguments[n];return t.bindEvents.apply(t,[this].concat(i))},unbindEntityEvents:function(){t.deprecate("unbindEntityEvents renamed to unbindEvents in v3.");for(var e=arguments.length,i=Array(e),n=0;n<e;n++)i[n]=arguments[n];return t.unbindEvents.apply(t,[this].concat(i))}};e.extend(t.Object.prototype,r),e.extend(t.View.prototype,r),e.extend(t.CollectionView.prototype,r)}function s(){function i(){this.childEvents||this.options.childEvents?(t.deprecate("childEvents are deprecated. Use childViewEvents"),this.mergeOptions(this.options,["childEvents"]),this._childViewEvents=e.result(this,"childEvents")):this._childViewEvents=e.result(this,"childViewEvents"),this._childViewTriggers=e.result(this,"childViewTriggers")}e.extend(t.View.prototype,{_buildEventProxies:i}),e.extend(t.CollectionView.prototype,{_buildEventProxies:i})}function a(i,n,r,o){var s=t[o].prototype[i],a={};a[i]=function(){return this._nodep=!0,this[n].apply(this,arguments)},a[n]=function(){return this._nodep?this._nodep=!1:t.deprecate(r),s.apply(this,arguments)},e.extend(t[o].prototype,a)}function c(){a("_endBuffering","endBuffering","endBuffering is now private.","CollectionView"),a("_startBuffering","startBuffering","startBuffering is now private.","CollectionView"),a("_showCollection","showCollection","showCollection is now private.","CollectionView"),a("_showEmptyView","showEmptyView","showEmptyView is now private.","CollectionView"),a("_destroyEmptyView","destroyEmptyView","destroyEmptyView is now private.","CollectionView"),a("_checkEmpty","checkEmpty","checkEmpty is now private.","CollectionView"),a("_destroyChildren","destroyChildren","destroyChildren is now private.","CollectionView"),a("_proxyChildEvents","proxyChildEvents","proxyChildEvents is now private.","CollectionView"),a("_addChild","addChild","addChild is now private.","CollectionView");var i=t.CollectionView.prototype.constructor;e.extend(t.CollectionView.prototype,{constructor:function(){n.Events.on.call(this,"render:children",function(){this.triggerMethod("render:collection",this)}),n.Events.on.call(this,"before:render:children",function(){this.triggerMethod("before:render:collection",this)}),i.apply(this,arguments)},initRenderBuffer:function(){t.deprecate("initRenderBuffer is now private."),this._bufferedChildren=[]}})}function d(){var i=t.CompositeView.prototype._renderTemplate;e.extend(t.CompositeView.prototype,{_renderTemplate:function(){this.triggerMethod("before:render:template"),i.apply(this,arguments),this.triggerMethod("render:template")}})}function h(){t.Controller=t.Object.extend({constructor:function(e){this.options=e||{};var i=Array.prototype.slice.call(arguments);i[0]=this.options,t.deprecate("Marionette.Controller is deprecated. Use Marionette.Object"),t.Object.prototype.constructor.apply(this,i)},destroy:function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];return this.triggerMethod.apply(this,["before:destroy"].concat(t)),this.triggerMethod.apply(this,["destroy"].concat(t)),this.stopListening(),this}})}function l(){var i={"render:collection":!0,"render:template":!0},r=function(e){t.deprecate(e+" event is deprecated.")},o=n.View.prototype.listenTo;n.View.prototype.listenTo=function(t,n){i[n]&&r(n),e.isObject(n)&&e.each(n,function(e,t){i[t]&&r(t)}),o.apply(this,arguments)};var s=n.View.prototype.on;n.View.prototype.on=function(t){i[t]&&r(t),e.isObject(t)&&e.each(t,function(e,t){i[t]&&r(t)}),s.apply(this,arguments)}}function p(){var e=t.View.prototype.getChildView;a("_getChildView","getChildView","getChildView is deprecated. Use childView instead.","CollectionView"),a("_getEmptyView","getEmptyView","getEmptyView is deprecated. Use emptyView instead.","View");var i=t.View.prototype.getChildView;t.View=t.View.extend({getChildView:function(){return arguments.length?e.apply(this,arguments):i.apply(this,arguments)}})}function u(){t.ItemView=t.View.extend({constructor:function(){t.deprecate("Marionette.ItemView is deprecated. Use Marionette.View"),t.View.prototype.constructor.apply(this,arguments)}})}function g(){t.LayoutView=t.View.extend({constructor:function(){t.deprecate("Marionette.LayoutView is deprecated. Use Marionette.View"),t.View.prototype.constructor.apply(this,arguments)}})}function f(){var i=t.Application.prototype.constructor;t.Deferred=function(){return t.deprecate("Marionette.Deferred is deprecated and removed in v3."),n.$.Deferred.apply(this,arguments)},t.Application=t.Application.extend({constructor:function(){this._initCallbacks=new t.Callbacks,this.submodules={},i.apply(this,arguments)},addInitializer:function(e){t.deprecate("Application Initializers are deprecated and removed in v3."),this._initCallbacks.add(e)},start:function(e){this.triggerMethod("before:start",e),this._initCallbacks.run(e,this),this.triggerMethod("start",e)},module:function(i,n){var r=t.Module.getClass(n),o=e.toArray(arguments);return o.unshift(this),r.create.apply(r,o)}}),t.Callbacks=function(){this._deferred=t.Deferred(),this._callbacks=[]},e.extend(t.Callbacks.prototype,{add:function(t,i){var n=e.result(this._deferred,"promise");this._callbacks.push({cb:t,ctx:i}),n.then(function(e){i&&(e.context=i),t.call(e.context,e.options)})},run:function(e,t){this._deferred.resolve({options:e,context:t})},reset:function(){var i=this._callbacks;this._deferred=t.Deferred(),this._callbacks=[],e.each(i,function(e){this.add(e.cb,e.ctx)},this)}}),t.Module=function(i,n,r){t.deprecate("Marionette.module is deprecated and removed in v3."),this.moduleName=i,this.options=e.extend({},this.options,r),this.initialize=r.initialize||this.initialize,this.submodules={},this._setupInitializersAndFinalizers(),this.app=n,e.isFunction(this.initialize)&&this.initialize(i,n,this.options)},t.Module.extend=t.extend,e.extend(t.Module.prototype,n.Events,{startWithParent:!0,initialize:function(){},addInitializer:function(e){this._initializerCallbacks.add(e)},addFinalizer:function(e){this._finalizerCallbacks.add(e)},start:function(t){this._isInitialized||(e.each(this.submodules,function(e){e.startWithParent&&e.start(t)}),this.triggerMethod("before:start",t),this._initializerCallbacks.run(t,this),this._isInitialized=!0,this.triggerMethod("start",t))},stop:function(){this._isInitialized&&(this._isInitialized=!1,this.triggerMethod("before:stop"),e.invoke(this.submodules,"stop"),this._finalizerCallbacks.run(void 0,this),this._initializerCallbacks.reset(),this._finalizerCallbacks.reset(),this.triggerMethod("stop"))},addDefinition:function(e,t){this._runModuleDefinition(e,t)},_runModuleDefinition:function(i,r){if(i){var o=e.flatten([this,this.app,n,t,n.$,e,r]);i.apply(this,o)}},_setupInitializersAndFinalizers:function(){this._initializerCallbacks=new t.Callbacks,this._finalizerCallbacks=new t.Callbacks},triggerMethod:function(){for(var e=arguments.length,i=Array(e),n=0;n<e;n++)i[n]=arguments[n];return t.triggerMethod.apply(this,[this].concat(i))}}),e.extend(t.Module,{create:function(t,i,n){var r=t,o=e.drop(arguments,3);i=i.split(".");var s=i.length,a=[];return a[s-1]=n,e.each(i,function(e,i){var s=r;r=this._getModule(s,e,t,n),this._addModuleDefinition(s,r,a[i],o)},this),r},_getModule:function(t,i,n,r,o){var s=e.extend({},r),a=this.getClass(r),c=t[i];return c||(c=new a(i,n,s),t[i]=c,t.submodules[i]=c),c},getClass:function(e){var i=t.Module;return e?e.prototype instanceof i?e:e.moduleClass||i:i},_addModuleDefinition:function(e,t,i,n){var r=this._getDefine(i),o=this._getStartWithParent(i,t);r&&t.addDefinition(r,n),this._addStartWithParent(e,t,o)},_getStartWithParent:function(i,n){var r;return e.isFunction(i)&&i.prototype instanceof t.Module?(r=n.constructor.prototype.startWithParent,!!e.isUndefined(r)||r):!e.isObject(i)||(r=i.startWithParent,!!e.isUndefined(r)||r)},_getDefine:function(i){return!e.isFunction(i)||i.prototype instanceof t.Module?e.isObject(i)?i.define:null:i},_addStartWithParent:function(e,t,i){t.startWithParent=t.startWithParent&&i,t.startWithParent&&!t.startWithParentIsConfigured&&(t.startWithParentIsConfigured=!0,e.addInitializer(function(e){t.startWithParent&&t.start(e)}))}})}function v(){var i=function(e,t){return e.replace(/@ui\.[a-zA-Z-_$0-9]*/g,function(e){return t[e.slice(4)]})};t.normalizeUIString=function(e,n){return t.deprecate("normalizeUIString was removed in v3."),i.apply(this,arguments)};var n=function(t,n){return e.reduce(t,function(e,t,r){var o=i(r,n);return e[o]=t,e},{})};t.normalizeUIKeys=function(e,i){return t.deprecate("normalizeUIKeys was removed in v3."),n.apply(this,arguments)};var r=function o(t,n,r){return e.each(t,function(s,a){e.isString(s)?t[a]=i(s,n):e.isObject(s)&&e.isArray(r)&&(e.extend(s,o(e.pick(s,r),n)),e.each(r,function(t){var r=s[t];e.isString(r)&&(s[t]=i(r,n))}))}),t};t.normalizeUIValues=function(e,i,n){return t.deprecate("normalizeUIValues was removed in v3."),r.apply(this,arguments)}}function y(){t.proxyGetOption=function(e){return t.deprecate("proxyGetOption has been deprecated and removed in v3."),t.getOption(this,e)},t.proxyBindEntityEvents=function(e,i){return t.deprecate("proxyBindEntityEvents has been deprecated and removed in v3."),t.bindEvents(this,e,i)},t.proxyUnbindEntityEvents=function(e,i){return t.deprecate("proxyUnbindEntityEvents has been deprecated and removed in v3."),t.unbindEvents(this,e,i)}}function w(){var e=t.Region.prototype.show;t.Region=t.Region.extend({attachView:function(e){return t.deprecate("Region#attachView was removed in v3. Use Region#show without fear of re-rendering."),this.currentView&&delete this.currentView._parent,e._parent=this,this.currentView=e,this},show:function(t,i){if(this._ensureElement(i)){if(this._ensureView(t),t===this.currentView)return this;var n=!!this.currentView;return n&&(this.triggerMethod("before:swapOut",this.currentView,this,i),this.triggerMethod("before:swap",t,this,i),this.triggerMethod("swapOut",this.currentView,this,i)),e.apply(this,arguments),n&&this.triggerMethod("swap",t,this,i),this}}})}function m(){t.RegionManager=t.Object.extend({constructor:function(e){this._regions={},this.length=0,t.Object.call(this,e),this.addRegions(this.getOption("regions"))},addRegions:function(i,n){return i=t._getValue(i,this,arguments),e.isEmpty(i)||t.deprecate("RegionManager is deprecated and removed in v3."),e.reduce(i,function(t,i,r){return e.isString(i)&&(i={selector:i}),i.selector&&(i=e.defaults({},i,n)),t[r]=this.addRegion(r,i),t},{},this)},addRegion:function(e,i){var n;return n=i instanceof t.Region?i:t.Region.buildRegion(i,t.Region),this.triggerMethod("before:add:region",e,n),n._parent=this,this._store(e,n),this.triggerMethod("add:region",e,n),n},get:function(e){return this._regions[e]},getRegions:function(){return e.clone(this._regions)},removeRegion:function(e){var t=this._regions[e];return this._remove(e,t),t},removeRegions:function(){var t=this.getRegions();return e.each(this._regions,function(e,t){this._remove(t,e)},this),t},emptyRegions:function(){var t=this.getRegions();return e.invoke(t,"empty"),t},destroy:function(){return this.removeRegions(),t.Object.prototype.destroy.apply(this,arguments)},_store:function(e,t){this._regions[e]||this.length++,this._regions[e]=t},_remove:function(e,t){this.triggerMethod("before:remove:region",e,t),t.empty(),t.stopListening(),delete t._parent,delete this._regions[e],this.length--,this.triggerMethod("remove:region",e,t)}});var i=function(t,i){var n=["forEach","each","map","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","toArray","first","initial","rest","last","without","isEmpty","pluck"];e.each(n,function(n){t[n]=function(){var t=e.values(e.result(this,i)),r=[t].concat(e.toArray(arguments));return e[n].apply(e,r)}})};t.actAsCollection=function(e,n){return t.deprecate("actAsCollection is deprecated and removed in v3."),i.apply(this,arguments)},i(t.RegionManager.prototype,"_regions")}function _(){function i(){t.deprecate("Show events are no longer triggered on the View.  User render or attach.")}function r(e,t,i){return i.toUpperCase()}var o=t.Region.prototype.triggerMethod;t.Region.prototype.triggerMethod=function(e,i,n,r){var s;return"before:show"===e||"show"===e?(s=o.call(this,e,n,i,r),n._isShown||t.triggerMethodOn(n,e,n,i,r),"show"===e&&(n._isShown=!0),n.children&&n.children.each(function(i){i._isShown||t.triggerMethodOn(i,e,i),"show"===e&&(i._isShown=!0)})):s=o.apply(this,arguments),s};var s=t.CollectionView.prototype._addChildView;t.CollectionView.prototype._addChildView=function(e){s.apply(this,arguments),this._isShown&&(e._isShown||(t.triggerMethodOn(e,"before:show",e),t.triggerMethodOn(e,"show",e)),e._isShown=!0)};var a=/(^|:)(\w)/gi,c=n.Events.trigger;n.Events.trigger=function(o){var s=this.prototype instanceof n.View||this===n.View,d=this.prototype instanceof t.Region||this===t.Region;if(s||d){var h="on"+o.replace(a,r),l=this.options&&this.options[h]||this[h];if(e.isFunction(l)&&(s?i():l.length>1&&t.deprecate("Region show events in v3 pass the region and the 1st argument and the view as the 2nd")),!this._events)return this;"before:show"!==o&&"show"!==o||!this._events[o]||(s?i():this._events[o].length>1&&t.deprecate("Region show events in v3 pass the region and the 1st argument and the view as the 2nd"))}return c.apply(this,arguments)}}function b(){function i(){t.deprecate("Regions attached to the Application are deprecated. Application now only has a single region.")}var n=t.Application.prototype.constructor;t.Application=t.Application.extend({constructor:function(e){this._initializeRegions(e),n.apply(this,arguments)},addRegions:function(e){return this._regionManager.addRegions(e)},emptyRegions:function(){return this._regionManager.emptyRegions()},removeRegion:function(e){return this._regionManager.removeRegion(e)},getRegion:function(e){return arguments.length?(i(),this._regionManager.get(e)):this._region},getRegions:function(){return this._regionManager.getRegions()},getRegionManager:function(){return new t.RegionManager},_initializeRegions:function(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],n=e.isFunction(this.regions)?this.regions(t):this.regions||{},r=t.options&&t.options.regions||t.regions;return e.isFunction(r)&&(r=r.call(this,t)),e.extend(n,r),this._initRegionManager(),e.isEmpty(n)||(i(),this.addRegions(n)),this},_initRegionManager:function(){this._regionManager=this.getRegionManager(),this._regionManager._parent=this,this.listenTo(this._regionManager,"before:add:region",function(e,t){this.triggerMethod("before:add:region",e,t)}),this.listenTo(this._regionManager,"add:region",function(e,t){this[e]=t,this.triggerMethod("add:region",e,t)}),this.listenTo(this._regionManager,"before:remove:region",function(e,t){this.triggerMethod("before:remove:region",e,t)}),this.listenTo(this._regionManager,"remove:region",function(e,t){delete this[e],this.triggerMethod("remove:region",e,t)})}})}function V(){function i(){t.deprecate("Regions attached to the view are deprecated. Use View#getRegion or View#showChildView")}function r(t,n,r){var o=r.show,s=r.empty,a=r.reset,c=r.on,d=e.extend({},r,{on:function(){i(),c.apply(this,arguments)},show:function(){i(),o.apply(this,arguments)},empty:function(){i(),s.apply(this,arguments)},reset:function(){i(),a.apply(this,arguments)},__deprecatedRegion:!0});t[n]=d}function o(e,t,i){delete e[t]}var s=n.View.prototype.listenTo;n.View.prototype.listenTo=function(e){e.__deprecatedRegion&&i(),s.apply(this,arguments)};var a=t.View.prototype._initRegions;e.extend(t.View.prototype,{_initRegions:function(){this.regionClass=t.Region,this.on({"add:region":r,"remove:region":o}),a.apply(this,arguments)}})}function C(){e.extend(t.Region,{buildRegion:function(i,n){if(t.deprecate("Region Static Options are deprecated and removed in v3."),e.isString(i))return this._buildRegionFromSelector(i,n);if(i.selector||i.el||i.regionClass)return this._buildRegionFromObject(i,n);if(e.isFunction(i))return this._buildRegionFromRegionClass(i);throw new t.Error({message:"Improper region configuration type.",url:"marionette.region.html#region-configuration-types"})},_buildRegionFromSelector:function(e,t){return new t({el:e})},_buildRegionFromObject:function(t,i){var n=t.regionClass||i,r=e.omit(t,"selector","regionClass");return t.selector&&!r.el&&(r.el=t.selector),new n(r)},_buildRegionFromRegionClass:function(e){return new e}})}function E(){function i(){var i=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];if(this.templateHelpers||this.options.templateHelpers){t.deprecate("templateHelpers are deprecated. Use templateContext"),this.mergeOptions(this.options,["templateHelpers"]);var n=e.result(this,"templateHelpers");return e.extend(i,n)}var r=e.result(this,"templateContext");return e.extend(i,r)}function n(){t.deprecate("mixinTemplateHelpers was renamed mixinTemplateContext in v3."),i.apply(this,arguments)}e.extend(t.View.prototype,{mixinTemplateContext:i,mixinTemplateHelpers:n}),e.extend(t.CompositeView.prototype,{mixinTemplateContext:i,mixinTemplateHelpers:n})}function M(){function i(e,t,i){return i.toUpperCase()}function n(n){for(var s=arguments.length,a=Array(s>1?s-1:0),c=1;c<s;c++)a[c-1]=arguments[c];var d=this._parentView();if(d){a=a||[];var h=e.result(d,"childViewEventPrefix"),l=h+":"+n,p="on"+l.replace(r,i),u=d.options&&d.options[p]||d[p];return(e.isFunction(u)&&u.length)!==a.length+1&&(d._events&&d._events[l]&&d._events[l].length)!==a.length+1||(a=[this].concat(a),t.deprecate("The triggering view is no longer prepended on to the arguments of proxied child events.")),o.apply(this,[n].concat(a))}}var r=/(^|:)(\w)/gi,o=t.View.prototype._triggerEventOnParentLayout;e.extend(t.View.prototype,{_triggerEventOnParentLayout:n}),e.extend(t.CompositeView.prototype,{_triggerEventOnParentLayout:n})}function R(){var i=t.View.prototype.constructor;t.View=t.View.extend({constructor:function(n){var r=Array.prototype.slice.call(arguments);e.isFunction(n)&&(t.deprecate("Marionette.View options is no longer supported as a function. Please use an object instead."),n=n(),r[0]=n),i.apply(this,r)}})}function x(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],i=e.extend({ApplicationWreqr:r,bindEntityEvents:o,childEvents:s,CollectionView:c,CompositeView:d,Controller:h,deprecatedEvents:l,getChildView:p,ItemView:u,LayoutView:g,Module:f,normalizeUi:v,proxyFunctions:y,Region:w,RegionManager:m,RegionShowEvent:_,regionsOnApplication:b,regionsOnView:V,RegionStaticMethods:C,templateHelpers:E,triggerProxy:M,viewOptions:R},t);e.mapObject(i,function(t){e.isFunction(t)&&t()})}return e="default"in e?e["default"]:e,t="default"in t?t["default"]:t,i="default"in i?i["default"]:i,n="default"in n?n["default"]:n,t.DEV_MODE=!0,t.VERSION="marionette-v3-compat",t.deprecate._warn=function(){var e=t.deprecate._console.warn||t.deprecate._console.log||function(){};return console.trace(),e.apply(t.deprecate._console,arguments)},t._getValue=function(t,i,n){return e.isFunction(t)&&(t=n?t.apply(i,n):t.call(i)),t},x});
//# sourceMappingURL=marionette-v3-compat.min.js.map
